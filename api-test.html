<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #e6ffe6; }
        .error { background-color: #ffe6e6; }
        button { margin: 5px; padding: 10px; }
    </style>
</head>
<body>
    <h1>API Test</h1>
    <div>
        <button onclick="testConnection()">Verbindung testen</button>
        <button onclick="loadDienstanfragen()">Dienstanfragen laden</button>
        <button onclick="createTestDienstanfrage()">Test-Dienstanfrage erstellen</button>
    </div>
    <div id="results"></div>

    <script src="js/api.js"></script>
    <script>
        const resultsDiv = document.getElementById('results');

        function addResult(message, isSuccess = true) {
            const div = document.createElement('div');
            div.className = `result ${isSuccess ? 'success' : 'error'}`;
            div.textContent = message;
            resultsDiv.insertBefore(div, resultsDiv.firstChild);
        }

        async function testConnection() {
            try {
                const isConnected = await testBackendConnection();
                addResult(isConnected ? 'Backend ist verbunden!' : 'Backend nicht erreichbar');
            } catch (error) {
                addResult('Fehler beim Verbindungstest: ' + error.message, false);
            }
        }

        async function loadDienstanfragen() {
            try {
                const anfragen = await getDienstanfragen();
                addResult('Dienstanfragen geladen: ' + JSON.stringify(anfragen, null, 2));
            } catch (error) {
                addResult('Fehler beim Laden der Dienstanfragen: ' + error.message, false);
            }
        }

        async function createTestDienstanfrage() {
            try {
                const testAnfrage = {
                    mitarbeiterId: '2',
                    datum: '2025-04-18',
                    position: 'kassa',
                    status: 'offen'
                };
                const result = await saveDienstanfrage(testAnfrage);
                addResult('Dienstanfrage erstellt: ' + JSON.stringify(result, null, 2));
            } catch (error) {
                addResult('Fehler beim Erstellen der Dienstanfrage: ' + error.message, false);
            }
        }
    </script>
</body>
</html>
