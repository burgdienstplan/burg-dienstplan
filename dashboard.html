<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Burg Hochosterwitz - Dashboard</title>
    <style>
        :root {
            --burg-rot: #8B0000;
            --pergament: #F5E6D3;
            --stein-grau: #4A4A4A;
            --text-weiss: #FFFFFF;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background-color: var(--stein-grau);
        }

        .header {
            background-color: var(--burg-rot);
            color: var(--text-weiss);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .content {
            background-color: var(--pergament);
            margin: 2rem;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .dashboard-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .dashboard-card:hover {
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-icon {
            font-size: 2rem;
            margin-right: 1rem;
            color: var(--burg-rot);
        }

        .card-title {
            color: var(--burg-rot);
            margin: 0;
            font-size: 1.25rem;
        }

        .card-content {
            color: var(--stein-grau);
        }

        button {
            padding: 0.75rem 1.5rem;
            background-color: var(--burg-rot);
            color: var(--text-weiss);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
            width: 100%;
            margin-top: 1rem;
        }

        button:hover {
            background-color: #a00000;
        }

        .logout-btn {
            background-color: var(--stein-grau);
        }

        .logout-btn:hover {
            background-color: #333;
        }

        .version-info {
            text-align: center;
            color: var(--stein-grau);
            margin-top: 2rem;
            font-size: 0.9rem;
        }

        .saison-info {
            background: var(--burg-rot);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: bold;
        }

        .notification {
            background-color: #e8f5e9;
            color: #2e7d32;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
        }

        .notification.warning {
            background-color: #fff3e0;
            color: #ed6c02;
        }

        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 2rem;
            color: var(--burg-rot);
            font-weight: bold;
        }

        .stat-label {
            color: var(--stein-grau);
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Dashboard v2025.2</h1>
        <button class="logout-btn" onclick="logout()">Abmelden</button>
    </div>

    <div class="content">
        <div class="saison-info">
            Saison 2025: 1. April - 1. November
        </div>

        <div id="notifications">
            <!-- Benachrichtigungen werden hier dynamisch eingefÃ¼gt -->
        </div>

        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-number" id="mitarbeiterCount">0</div>
                <div class="stat-label">Aktive Mitarbeiter</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="urlaubCount">0</div>
                <div class="stat-label">Offene UrlaubsantrÃ¤ge</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="shiftsToday">0</div>
                <div class="stat-label">Schichten heute</div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Dienstplan -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">ðŸ“…</div>
                    <h2 class="card-title">Dienstplan</h2>
                </div>
                <div class="card-content">
                    <p>Verwalten Sie den Dienstplan fÃ¼r alle Mitarbeiter.</p>
                    <button onclick="window.location.href='dienstplan.html'">Zum Dienstplan</button>
                </div>
            </div>

            <!-- Urlaubsverwaltung -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">ðŸŒ´</div>
                    <h2 class="card-title">Urlaubsverwaltung</h2>
                </div>
                <div class="card-content">
                    <p>Bearbeiten Sie UrlaubsantrÃ¤ge und planen Sie Abwesenheiten.</p>
                    <button onclick="window.location.href='urlaub.html'">Zur Urlaubsverwaltung</button>
                </div>
            </div>

            <!-- Mitarbeiterverwaltung (nur fÃ¼r Admin) -->
            <div class="dashboard-card" id="adminCard" style="display: none;">
                <div class="card-header">
                    <div class="card-icon">ðŸ‘¥</div>
                    <h2 class="card-title">Mitarbeiterverwaltung</h2>
                </div>
                <div class="card-content">
                    <p>Verwalten Sie alle Mitarbeiter und deren Berechtigungen.</p>
                    <button onclick="window.location.href='mitarbeiter.html'">Zur Mitarbeiterverwaltung</button>
                </div>
            </div>

            <!-- PersÃ¶nliche Ãœbersicht -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-icon">ðŸ‘¤</div>
                    <h2 class="card-title">Meine Ãœbersicht</h2>
                </div>
                <div class="card-content" id="personalOverview">
                    <!-- Wird dynamisch gefÃ¼llt -->
                </div>
            </div>
        </div>

        <div class="version-info">
            <p>Burg Hochosterwitz Dienstplan v2025.2</p>
            <p> 2025 Burg Hochosterwitz. Alle Rechte vorbehalten.</p>
        </div>
    </div>

    <script src="js/database.js"></script>
    <script>
        const db = new Database();
        
        // ÃœberprÃ¼fe Login-Status
        async function checkLogin() {
            const currentUser = await db.getItem('currentUser');
            if (!currentUser) {
                window.location.href = 'index.html';
                return;
            }

            // Admin-Bereich anzeigen
            if (currentUser.rolle === 'admin') {
                document.getElementById('adminCard').style.display = 'block';
            }

            loadDashboard();
        }

        async function loadDashboard() {
            // Statistiken laden
            const mitarbeiter = await db.getMitarbeiter();
            const urlaubsanfragen = await db.getUrlaubsanfragen();
            const heute = new Date().toISOString().split('T')[0];
            const shifts = await db.getShifts(heute);

            // Statistiken aktualisieren
            document.getElementById('mitarbeiterCount').textContent = 
                mitarbeiter.filter(m => m.aktiv).length;
            document.getElementById('urlaubCount').textContent = 
                urlaubsanfragen.filter(u => u.status === 'pending').length;
            document.getElementById('shiftsToday').textContent = shifts.length;

            // PersÃ¶nliche Ãœbersicht
            const currentUser = await db.getItem('currentUser');
            const personalOverview = document.getElementById('personalOverview');
            const userShifts = shifts.filter(s => s.mitarbeiterId === currentUser.id);
            const userUrlaub = urlaubsanfragen.filter(u => 
                u.mitarbeiterId === currentUser.id && 
                u.status === 'pending'
            );

            personalOverview.innerHTML = `
                <p><strong>Meine Schichten heute:</strong> ${userShifts.length}</p>
                <p><strong>Offene UrlaubsantrÃ¤ge:</strong> ${userUrlaub.length}</p>
                <button onclick="window.location.href='profil.html'">Mein Profil</button>
            `;

            // Benachrichtigungen
            const notifications = document.getElementById('notifications');
            if (shifts.length === 0) {
                notifications.innerHTML += `
                    <div class="notification warning">
                        Heute sind noch keine Schichten eingeteilt!
                    </div>
                `;
            }
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // Initialisierung
        document.addEventListener('DOMContentLoaded', checkLogin);
    </script>
</body>
</html>
